{% extends 'grades/base.html' %}
{% load static %}  {# ← 一定要加這行才能用 static #}

{% block content %}
<h1>歡迎, {{ student.name }}</h1>

{% if student.profile_pic %}
    <img src="{{ student.profile_pic.url }}" alt="{{ student.name }}" width="120" height="120" style="border-radius:50%;">
{% else %}
    <img src="{% static 'default.png' %}" alt="預設大頭照" width="120" height="120" style="border-radius:50%;">
{% endif %}

<h2>修課清單</h2>
<table border="1" cellpadding="6">
  <tr>
    <th>課名</th>
    <th>期中</th>
    <th>期末</th>
    <th>平均</th>
    <th>動作</th>
  </tr>
  {% for e in enrollments %}
  <tr>
    <td><a href="{% url 'grades:course_detail' e.course.id %}">{{ e.course.title }}</a></td>
    <td>{{ e.midterm_score }}</td>
    <td>{{ e.final_score }}</td>
    <td>{{ e.average|floatformat:2 }}</td>
    <td><a href="{% url 'grades:unenroll_course' e.course.id %}">退選</a></td>
  </tr>
  {% empty %}
  <tr><td colspan="5">尚未修課</td></tr>
  {% endfor %}
</table>

{% if overall_avg %}
<p>總平均: {{ overall_avg|floatformat:2 }}</p>
{% endif %}

<h2>可選課程</h2>
<ul>
  {% for c in courses %}
  <li>{{ c.title }} - <a href="{% url 'grades:enroll_course' c.id %}">加選</a></li>
  {% empty %}
  <li>目前沒有可選課程</li>
  {% endfor %}
</ul>
{% endblock %}
